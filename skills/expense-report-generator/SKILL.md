---
name: expense-report-generator
description: 此技能用于根据滴滴行程汇总和火车票提取结果，自动生成符合特定格式要求的费用清单 Excel 文件。它支持自动处理金额格式、边框样式、汇总行以及分类命名。
---

# Expense Report Generator

此技能专门用于将原始的交通行程数据（滴滴、火车票等）汇总并转化为标准格式的费用清单报销单。

## 使用场景
- 当用户提供了滴滴行程汇总 Excel 和火车票提取结果 Excel，需要汇总成一份费用清单时使用。
- 需要自动处理金额的货币格式（¥0.00）。
- 需要自动生成合计行和求和公式。
- 需要保持特定的表格样式（如合并单元格边框处理）。

## 核心功能
1. **多源数据汇总**：整合滴滴行程和火车票行程，统一按日期排序。
2. **自动分类映射**：
   - 火车票 $\rightarrow$ 事由为 `出差交通(出发-目的)`，类别为 `长途交通费`。
   - 滴滴 $\rightarrow$ 事由为 `市内交通`，类别为 `市内交通费`。
3. **格式与美化**：
   - 自动应用 `assets/expense_template.xlsx` 中的边框和字体样式。
   - 自动设置金额列为 `¥#,##0.00` 格式。
   - 特殊处理 `A2:F2` 合并单元格的边框，移除左右侧线。
4. **自动化脚本**：提供 `scripts/generate_report.py` 脚本进行一键处理。

## 使用指南
1. **准备输入文件**：
   - 滴滴行程：`滴滴行程汇总_技能执行版.xlsx`
   - 火车票：`火车票提取结果_最新.xlsx`
2. **运行生成脚本**：
   使用 Python 执行 `scripts/generate_report.py`。
   脚本将：
   - 读取输入文件。
   - 加载 `assets/expense_template.xlsx` 作为样式参考。
   - 输出 `费用清单_最新版.xlsx`。

## 注意事项
- 输入文件的列名必须符合脚本预期（如：火车票需包含 `departure_station`, `arrival_station`, `price`, `date`；滴滴需包含 `上车时间`, `金额[元]`）。
- 脚本会自动补全滴滴行程的年份（默认为 2025 年）。
